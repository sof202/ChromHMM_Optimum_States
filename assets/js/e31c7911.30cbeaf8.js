"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[3893],{8305:(e,s,a)=>{a.r(s),a.d(s,{assets:()=>h,contentTitle:()=>l,default:()=>c,frontMatter:()=>n,metadata:()=>r,toc:()=>m});var t=a(5893),i=a(1151);const n={sidebar_position:1},l="ChromHMM overview",r={id:"ChromOptimise/ChromHMM-overview",title:"ChromHMM overview",description:"ChromHMM is a tool created by Jason Ernst and Manolis Kellis. It uses the Baum-Welch algorithm to train a hidden Markov model to help characterise chromatin states for a genomic dataset (specifically one that can be peak called). This page covers what a hidden Markov model actually is and how the model is trained.",source:"@site/docs/ChromOptimise/ChromHMM-overview.md",sourceDirName:"ChromOptimise",slug:"/ChromOptimise/ChromHMM-overview",permalink:"/ChromOptimise/ChromOptimise/ChromHMM-overview",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"documentationSidebar",next:{title:"Data structure",permalink:"/ChromOptimise/ChromOptimise/Data-structure"}},h={},m=[{value:"Hidden Markov models",id:"hidden-markov-models",level:2},{value:"Estimated log likelihood",id:"estimated-log-likelihood",level:2}];function o(e){const s={a:"a",annotation:"annotation",em:"em",h1:"h1",h2:"h2",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",p:"p",semantics:"semantics",span:"span",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"chromhmm-overview",children:"ChromHMM overview"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://compbio.mit.edu/ChromHMM/#:~:text=ChromHMM%20is%20software%20for%20learning,and%20spatial%20patterns%20of%20marks.",children:"ChromHMM"})," is a tool created by Jason Ernst and Manolis Kellis. It uses the Baum-Welch algorithm to train a hidden Markov model to help characterise chromatin states for a genomic dataset (specifically one that can be peak called). This page covers what a hidden Markov model actually is and how the model is trained."]}),"\n",(0,t.jsx)(s.h2,{id:"hidden-markov-models",children:"Hidden Markov models"}),"\n",(0,t.jsx)(s.p,{children:"Hidden Markov models are a subset of Markov models. A common example used to describe how such models work involve weather prediction. Suppose there are three types of weather: Sunny, cloudy and rainy. Markov models could be applied to predict what the weather will be like on each day of a given week."}),"\n",(0,t.jsxs)(s.p,{children:["In a Markov model, one knows what the weather is like today and uses this information to make a prediction for the weather tommorow. It is assumed that there is a fixed rate of transitioning between each state (weather type) for each day, and the weather for tommorow only depends on today's weather ('memoryless property'). The model consists of transition probabilities between each weather state only. For example: if it is rainy today, it is unlikely to be sunny tommorow; if it is sunny today, it is likely to be sunny again tommorow; if it is cloudy today, it is equally likely be rainy, sunny or cloudy again tommorow (",(0,t.jsx)(s.em,{children:"etc."}),"). A useful property of Markov models is that they only rely on the previous state, therefore (in this example) the weather for next week (or next month ",(0,t.jsx)(s.em,{children:"etc."}),") can be predicted using today's weather only (albeit poorly)."]}),"\n",(0,t.jsxs)(s.p,{children:["In a ",(0,t.jsx)(s.em,{children:"hidden"})," Markov model, one no longer knows what the weather is like today. Instead they recieve indirect observations that are assumed to be dependent on the state of the weather. These observations could be anything from the temperature to the clothes their friends are wearing that day. These models are called hidden markov models as the states (weather) is no longer directly observable. These models still use the transition probabilities between  states seen in normal markov models, but now have the added feature of emission probabilities. These emission probabilites are the probability of some obseravation ",(0,t.jsx)(s.em,{children:"given"})," a certain state. In the weather example: Sunny days are likely to be hot, people are likely to wear coats when it rains (",(0,t.jsx)(s.em,{children:"etc."}),"). A combination of the observations and the previously assumed state are used to make predictions on the following state."]}),"\n",(0,t.jsxs)(s.p,{children:["Hidden markov models therefore are very useful in the context of chromatin analysis. Instead of weather states, we now have specific chromatin states (such as genes, intronic regions, transcription end sites ",(0,t.jsx)(s.em,{children:"etc."}),"). Instead of observations of temperature, clothing ",(0,t.jsx)(s.em,{children:"etc."})," we instead have combinations of epigenetic marks. Hidden Markov models can therefore make predictions on the genome that would be difficult to make otherwise."]}),"\n",(0,t.jsx)(s.h2,{id:"estimated-log-likelihood",children:"Estimated log likelihood"}),"\n",(0,t.jsx)(s.p,{children:"In order to train the parameters for a hidden Markov model, ChromHMM uses the Baum-Welch algorithm. The aim of the Baum-Welch algorithm is to maximise the 'likelihood function'. The 'likelihood function' is a metric used to identify how accurate a model is when comparing it to the dataset."}),"\n",(0,t.jsx)(s.p,{children:"Informally, the likelihood function is 'the probability that this sequence of observations would be observed under the hidden Markov model'."}),"\n",(0,t.jsxs)(s.p,{children:["Formally, the likelihood funtion: ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"P"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"("}),(0,t.jsx)(s.mi,{children:"O"}),(0,t.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,t.jsx)(s.mi,{children:"\u03bb"}),(0,t.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"P(O | \u03bb)"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"P"}),(0,t.jsx)(s.span,{className:"mopen",children:"("}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(s.span,{className:"mclose",children:")"})]})})]})," is ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsxs)(s.mrow,{children:[(0,t.jsx)(s.mi,{children:"P"}),(0,t.jsx)(s.mo,{stretchy:"false",children:"("}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"O"}),(0,t.jsx)(s.mn,{children:"1"})]}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"O"}),(0,t.jsx)(s.mn,{children:"2"})]}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsx)(s.mo,{children:"\u2026"}),(0,t.jsx)(s.mo,{separator:"true",children:","}),(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"O"}),(0,t.jsx)(s.mi,{children:"T"})]}),(0,t.jsx)(s.mi,{mathvariant:"normal",children:"\u2223"}),(0,t.jsx)(s.mi,{children:"\u03bb"}),(0,t.jsx)(s.mo,{stretchy:"false",children:")"})]}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"P(O_1,O_2,\\dots,O_T | \u03bb)"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"P"}),(0,t.jsx)(s.span,{className:"mopen",children:"("}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"1"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3011em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mtight",children:"2"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"minner",children:"\u2026"}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsx)(s.span,{className:"mpunct",children:","}),(0,t.jsx)(s.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3283em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"T"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]}),(0,t.jsx)(s.span,{className:"mord",children:"\u2223"}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"\u03bb"}),(0,t.jsx)(s.span,{className:"mclose",children:")"})]})})]})," where:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsxs)(s.msub,{children:[(0,t.jsx)(s.mi,{children:"O"}),(0,t.jsx)(s.mi,{children:"i"})]})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"O_i"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,t.jsxs)(s.span,{className:"mord",children:[(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,t.jsx)(s.span,{className:"msupsub",children:(0,t.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,t.jsxs)(s.span,{className:"vlist-r",children:[(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.3117em"},children:(0,t.jsxs)(s.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,t.jsx)(s.span,{className:"pstrut",style:{height:"2.7em"}}),(0,t.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,t.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,t.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,t.jsx)(s.span,{className:"vlist-r",children:(0,t.jsx)(s.span,{className:"vlist",style:{height:"0.15em"},children:(0,t.jsx)(s.span,{})})})]})})]})]})})]})," is the observation at time/position ",(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"i"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"i"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6595em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"i"})]})})]})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"T"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"T"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6833em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"})]})})]})," is the total number of observations"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsxs)(s.span,{className:"katex",children:[(0,t.jsx)(s.span,{className:"katex-mathml",children:(0,t.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,t.jsxs)(s.semantics,{children:[(0,t.jsx)(s.mrow,{children:(0,t.jsx)(s.mi,{children:"\u03bb"})}),(0,t.jsx)(s.annotation,{encoding:"application/x-tex",children:"\u03bb"})]})})}),(0,t.jsx)(s.span,{className:"katex-html","aria-hidden":"true",children:(0,t.jsxs)(s.span,{className:"base",children:[(0,t.jsx)(s.span,{className:"strut",style:{height:"0.6944em"}}),(0,t.jsx)(s.span,{className:"mord mathnormal",children:"\u03bb"})]})})]})," is the parameters of the hidden Markov model:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The transition probabilities between states"}),"\n",(0,t.jsx)(s.li,{children:"The emission probabilities of each state"}),"\n",(0,t.jsx)(s.li,{children:"The initial state probabilities"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["The likelihood function is calculated using the ",(0,t.jsx)(s.a,{href:"https://en.wikipedia.org/wiki/Forward%E2%80%93backward_algorithm",children:"forwards-backwards algorithm"})," which is outlined in full in ",(0,t.jsx)(s.a,{href:"https://www.cs.ubc.ca/~murphyk/Bayes/rabiner.pdf",children:"this document"}),"."]})]})}function c(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},1151:(e,s,a)=>{a.d(s,{Z:()=>r,a:()=>l});var t=a(7294);const i={},n=t.createContext(i);function l(e){const s=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(n.Provider,{value:s},e.children)}}}]);