"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8244],{1251:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>r,contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>m});var n=i(5893),t=i(1151);const a={title:"3_SubsampleBamFiles",description:"The script used to merge and subsample processed files.",sidebar_position:5},o="3_SubsampleBamFiles",l={id:"ChromOptimise/Pipeline-Explanation/SubsampleBamFiles",title:"3_SubsampleBamFiles",description:"The script used to merge and subsample processed files.",source:"@site/docs/ChromOptimise/Pipeline-Explanation/3_SubsampleBamFiles.md",sourceDirName:"ChromOptimise/Pipeline-Explanation",slug:"/ChromOptimise/Pipeline-Explanation/SubsampleBamFiles",permalink:"/ChromOptimise/ChromOptimise/Pipeline-Explanation/SubsampleBamFiles",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"3_SubsampleBamFiles",description:"The script used to merge and subsample processed files.",sidebar_position:5},sidebar:"documentationSidebar",previous:{title:"2_batch_ProcessBamFiles",permalink:"/ChromOptimise/ChromOptimise/Pipeline-Explanation/batch_ProcessBamFiles"},next:{title:"4_BinarizeFiles",permalink:"/ChromOptimise/ChromOptimise/Pipeline-Explanation/BinarizeFiles"}},r={},m=[{value:"Explanation",id:"explanation",level:2},{value:"Example usage",id:"example-usage",level:2}];function p(e){const s={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"3_subsamplebamfiles",children:"3_SubsampleBamFiles"}),"\n",(0,n.jsx)(s.admonition,{title:"Skipping script 2",type:"warning",children:(0,n.jsx)(s.p,{children:"If you skipped script 2 (2_batch_ProcessBamFiles.sh), please ensure that your files are separated into different folders (by epigenetic mark). The names of these folders doesn't matter, but we recommend naming them after the epignetic mark name (so help messages make sense)."})}),"\n",(0,n.jsx)(s.h2,{id:"explanation",children:"Explanation"}),"\n",(0,n.jsxs)(s.p,{children:["This merges all of the processed ",(0,n.jsx)(s.code,{children:".bam"})," files from the previous step using ",(0,n.jsx)(s.code,{children:"samtools merge"})," and subsequently subsamples this file using ",(0,n.jsx)(s.code,{children:"samtools view -s"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["The reason for merging files and subsampling instead of simply subsampling the original files is that it is unlikely that every processed ",(0,n.jsx)(s.code,{children:".bam"})," file is of the same size. If the ",(0,n.jsx)(s.code,{children:".bam"})," files are of different sizes, then different subsamples with the same number of files can have different sizes.\n",(0,n.jsx)(s.br,{}),"\n","This results in the different samples no longer being directly comparable as they will likely have different sizes."]}),"\n",(0,n.jsx)(s.admonition,{title:"Large number of files",type:"note",children:(0,n.jsxs)(s.p,{children:["If you are working with a lot of files, this step can use a large amount of memory due to the way samtools merges files, see ",(0,n.jsx)(s.a,{href:"/ChromOptimise/ChromOptimise/Memory-Profiling",children:"memory profiling"})," for more information."]})}),"\n",(0,n.jsx)(s.admonition,{title:"outdated samtools",type:"warning",children:(0,n.jsx)(s.p,{children:"Samtools had a known bug in version 0.1.18 where subsampling would fail if the sample size was above 50%, ensure that your version of samtools is up to date."})}),"\n",(0,n.jsx)(s.h2,{id:"example-usage",children:"Example usage"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'# Merges all files in ${PROCESSED_DIR}/H3k27me3 and subsamples this file\n# with sample size 75%\nsbatch 3_SubsampleBamFiles.sh \\\n--config="path/to/configuration/directory" \\\n--mark="H3K27me3" \\\n--samplesize=75\n'})})]})}function d(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},1151:(e,s,i)=>{i.d(s,{Z:()=>l,a:()=>o});var n=i(7294);const t={},a=n.createContext(t);function o(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);