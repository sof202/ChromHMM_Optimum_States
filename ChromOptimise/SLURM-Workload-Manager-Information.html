<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-ChromOptimise/SLURM-Workload-Manager-Information" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">SLURM information | ChromOptimise</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sof202.github.io/ChromOptimise/img/dna.png"><meta data-rh="true" name="twitter:image" content="https://sof202.github.io/ChromOptimise/img/dna.png"><meta data-rh="true" property="og:url" content="https://sof202.github.io/ChromOptimise/ChromOptimise/SLURM-Workload-Manager-Information"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SLURM information | ChromOptimise"><meta data-rh="true" name="description" content="The scripts included in this repository were designed to be used with SLURM"><meta data-rh="true" property="og:description" content="The scripts included in this repository were designed to be used with SLURM"><link data-rh="true" rel="icon" href="/ChromOptimise/img/dna.ico"><link data-rh="true" rel="canonical" href="https://sof202.github.io/ChromOptimise/ChromOptimise/SLURM-Workload-Manager-Information"><link data-rh="true" rel="alternate" href="https://sof202.github.io/ChromOptimise/ChromOptimise/SLURM-Workload-Manager-Information" hreflang="en"><link data-rh="true" rel="alternate" href="https://sof202.github.io/ChromOptimise/ChromOptimise/SLURM-Workload-Manager-Information" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/ChromOptimise/assets/css/styles.cefcd80b.css">
<script src="/ChromOptimise/assets/js/runtime~main.ca290197.js" defer="defer"></script>
<script src="/ChromOptimise/assets/js/main.901ebad5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ChromOptimise/"><div class="navbar__logo"><img src="/ChromOptimise/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ChromOptimise/img/logo.svg" alt="Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ChromOptimise</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ChromOptimise/ChromOptimise/ChromHMM-overview">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sof202/ChromOptimise" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ChromOptimise/ChromOptimise/ChromHMM-overview">ChromHMM overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ChromOptimise/ChromOptimise/Data-structure">Data structure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ChromOptimise/category/main-pipeline---usage-and-explanation">Main Pipeline - Usage and Explanation</a><button aria-label="Expand sidebar category &#x27;Main Pipeline - Usage and Explanation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ChromOptimise/category/supplementary-pipeline---usage-and-explanation">Supplementary Pipeline - Usage and Explanation</a><button aria-label="Expand sidebar category &#x27;Supplementary Pipeline - Usage and Explanation&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ChromOptimise/ChromOptimise/Factors-that-affect-the-output">Factors that affect the output</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ChromOptimise/ChromOptimise/Processing-Times">Processing times</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ChromOptimise/ChromOptimise/Memory-Profiling">Memory profiling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/ChromOptimise/ChromOptimise/SLURM-Workload-Manager-Information">SLURM information</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ChromOptimise/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">SLURM information</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>SLURM information</h1>
<p>The scripts included in this repository were designed to be used with SLURM
workload manager. As such, many elements of the scripts will not work if one
does not run them through SLURM&#x27;s <code>sbatch</code> command.</p>
<p>Here, we will outline the main areas of the code that depend on SLURM&#x27;s
<code>sbatch</code> command in order to function correctly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sbatch-lines"><code>#SBATCH</code> lines<a href="#sbatch-lines" class="hash-link" aria-label="Direct link to sbatch-lines" title="Direct link to sbatch-lines">​</a></h2>
<p>At the top of every script (after the shebang) there are
several comment lines that start: <code>#SBATCH</code>. These lines are read by SLURM and
give meta data on how the script should be ran. If running the script normally,
these lines will be interpreted as comments, resulting in loss of
functionality.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-files-the-most-important-aspect-that-is-lost-when-running-scripts">Log files The most important aspect that is lost when running scripts<a href="#log-files-the-most-important-aspect-that-is-lost-when-running-scripts" class="hash-link" aria-label="Direct link to Log files The most important aspect that is lost when running scripts" title="Direct link to Log files The most important aspect that is lost when running scripts">​</a></h2>
<p>outside of <code>sbatch</code> is the error logs. If one runs the scripts normally, all
outputs, warnings and errors will be printed to the terminal.</p>
<p>There will also be error messages from the hard links that are created in the
SET UP section of each script. SLURM workload manager is unable to create
folders in <code>#SBATCH</code> lines and naming of log files is limited. As a result, log
files are generated under temporary names and a hard link is made with a file
with a more descriptive name (which allows for a more organised structure of
your log files).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="slurm-environment-variables">SLURM environment variables<a href="#slurm-environment-variables" class="hash-link" aria-label="Direct link to SLURM environment variables" title="Direct link to SLURM environment variables">​</a></h2>
<p>Certain aspects of the scripts may lose there
functionality if they depend on environment variables that are set up when
running the script with SLURM&#x27;s <code>sbatch</code> command. Common SLURM environment
variables that were used were:</p>
<ul>
<li>SLURM_SUBMIT_DIR -&gt; This is the directory that the shell was in when the
script was initially ran,</li>
<li>SLURM_JOB_ID -&gt; This is the unique job identification number assigned to the
job at creation,</li>
<li>SLURM_JOB_NAME -&gt; This is the name of the job as defined in the <code>#SBATCH</code>
lines.</li>
</ul>
<p>Most instances of these variables are fine as they are not required for the
script to function</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="arrays">Arrays<a href="#arrays" class="hash-link" aria-label="Direct link to Arrays" title="Direct link to Arrays">​</a></h2>
<p>For scripts that start with &#x27;batch&#x27;, the job is designed to be ran as
a SLURM array (enabling parallelisation). If one does not run these scripts as
an array through <code>sbatch [script] --array=1-4</code> etc. then the script will fail.
This is because the parallel processing logic that is applied in these scripts
will result in division by 0 errors. Such errors occur as a blank variable is
interpreted as 0 when inside of $(()).</p>
<p>The following SLURM environment variables are the reason for this behaviour:</p>
<ul>
<li>SLURM_ARRAY_TASK_ID</li>
<li>SLURM_ARRAY_TASK_COUNT</li>
</ul>
<p>A fair amount of effort would be required to get such scripts to work without
the use of SLRUM. One would need to remove the parallelisation set up sections
and ensure that all files/models are being used/manipulated correctly in
subsequent sections/lines.</p>
<p>Please also note that the scripts rely on the array being 1 indexed.
<code>--array=0-1</code> is technically the exact same as <code>--array=1-2</code>, however the batch
scripts require 1 indexing for the modular arithmetic to work correctly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="time-and-memory-allocation">Time and memory allocation<a href="#time-and-memory-allocation" class="hash-link" aria-label="Direct link to Time and memory allocation" title="Direct link to Time and memory allocation">​</a></h2>
<p>SLURM workload manager allows one to set up a
peak memory allocation parameter and a maximum wall time for the submitted job.
These parameters are specified in the <code>#SBATCH</code> lines at the top of the
scripts. If one executes the script normally, the absence of these should not
matter. One may want to implement artificial maximum wall times regardless as
some programs can take a long time to finish and cause too much memory pile up
(resulting in a crash).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="module-purge-and-module-load"><code>module purge</code> and <code>module load</code><a href="#module-purge-and-module-load" class="hash-link" aria-label="Direct link to module-purge-and-module-load" title="Direct link to module-purge-and-module-load">​</a></h2>
<p>In most scripts you will see lines: <code>module purge</code> and <code>module load</code>. This is
due to the large quantity of software on the
HPC systems here at UoE. These commands are a part of the &#x27;Modules&#x27; tool and
help with compatability between different programs. The setup file in the home
directory of the repository gives one the option to remove all such lines
(reccomended).</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ChromOptimise/ChromOptimise/Memory-Profiling"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Memory profiling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#sbatch-lines" class="table-of-contents__link toc-highlight"><code>#SBATCH</code> lines</a></li><li><a href="#log-files-the-most-important-aspect-that-is-lost-when-running-scripts" class="table-of-contents__link toc-highlight">Log files The most important aspect that is lost when running scripts</a></li><li><a href="#slurm-environment-variables" class="table-of-contents__link toc-highlight">SLURM environment variables</a></li><li><a href="#arrays" class="table-of-contents__link toc-highlight">Arrays</a></li><li><a href="#time-and-memory-allocation" class="table-of-contents__link toc-highlight">Time and memory allocation</a></li><li><a href="#module-purge-and-module-load" class="table-of-contents__link toc-highlight"><code>module purge</code> and <code>module load</code></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 ChromOptimise, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>